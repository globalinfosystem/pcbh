/* jquery.minimuslider v.1.2 | (c) 2014 Federica Sibella musings(at)musings(dot)it | http://www.musings.it | MIT license */
!function(i){function t(t){var n=i("#minimus-slide"+t.instance+"_"+t.current),e=n.find("img");if(e.length>0){t.is_retina&&""!==e.attr("data-src-2x")?e.attr("src")!==e.attr("data-src-2x")&&e.attr("src",e.attr("data-src-2x")):e.attr("src")!==e.attr("data-src")&&e.attr("src",e.attr("data-src"));var a=e,r=new Image;r.onload=function(){var i=r.width,a=r.height,s=a/i,o=t.slider,d=t.calc_width,c=t.calc_height,m=Math.round(d*s);if("adjust"==t.options.ratio)n.css({height:m}),e.css({width:d,height:m}),o.css({height:m});else if(m>c){var u=Math.round((m-c)/2);e.css({width:d,height:m,top:-u})}else{var h=Math.round(c/s),l=Math.round((h-d)/2);e.css({width:h,height:c,left:-l})}},r.src=a.attr("src"),0===n.find(".minimus-caption").length&&void 0!==e.attr("title")&&""!==e.attr("title")&&n.append("<div class='minimus-caption'><p>"+e.attr("title")+"</p></div>").promise().done(function(){var i=n.find(".minimus-caption").outerHeight(!0);n.find(".minimus-caption").css({bottom:-i}).delay(800).animate({bottom:0},300)})}}function n(t){var n=i("#minimus-slide"+t.instance+"_"+t.current);if(n.find(".minimus-caption").length>0){var e=n.find(".minimus-caption").outerHeight(!0);n.find(".minimus-caption").css({bottom:-e}).delay(800).animate({bottom:0},300)}}function e(t,n,e){var r=i("#minimus-slide"+t.instance+"_"+t.current),s=i("#minimus-slide"+t.instance+"_"+n),o=t.options,d=t.calc_width,c=t.calc_height,m=0,u=0,h=t.prev,l=t.next;switch(h.off(),l.off(),i(document).on("touchend").off(),"n"==e?(m=d+t.margin,u=c+t.margin):"p"==e&&(m=-(d+t.margin),u=-(c+t.margin)),o.animation_type){case"horizontal":r.css({left:m}).show(),s.animate({left:-m},o.animation_duration,function(){s.hide().toggleClass("active")}),r.animate({left:0},o.animation_duration,function(){a(t)});break;case"vertical":r.css({top:u}).show(),s.animate({top:-u},o.animation_duration,function(){s.hide().toggleClass("active")}),r.animate({top:0},o.animation_duration,function(){a(t)});break;case"fade":s.fadeOut(o.animation_duration).toggleClass("active"),r.fadeIn(o.animation_duration,function(){a(t)})}}function a(t){var n=i("#minimus-slide"+t.instance+"_"+t.current),e=t.prev,a=t.next,r=t.slider,s=t.mm;n.toggleClass("active"),a.on("click touchstart touchend",function(t){t.preventDefault(),i(this).minimus("next")}),e.on("click touchstart touchend",function(t){t.preventDefault(),i(this).minimus("prev")}),i(document).on("touchstart",r,function(i){var t=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];void 0===i.originalEvent.touches&&(t=i),s.ox=t.pageX,s.oy=t.pageY,s.startTime=(new Date).getTime()}),i(document).on("touchend",r,function(i){var t=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];void 0===i.originalEvent.touches&&(t=i),s.dx=t.pageX-s.ox,s.dy=t.pageY-s.oy,s.endTime=(new Date).getTime()-s.startTime,(s.dx<-s.swipeTreshold||s.dy<-s.swipeTreshold)&&s.endTime<s.allowedTime?r.minimus("next"):(s.dx>s.swipeTreshold||s.dy>s.swipeTreshold)&&s.endTime<s.allowedTime&&r.minimus("prev")})}function r(t,n){var e,a=i("#minimus-slide"+t+"_"+n);a.children().is("audio,video")&&(e=a.children("audio,video"),e[0].paused===!1&&e[0].pause())}function s(i){if("string"==typeof i){var t=i.indexOf("_");-1!=t&&(i=i.substr(t+1))}return i}function o(i,t){var n=i;if("string"==typeof i){var e=i.indexOf("%");if(-1!=e){var a=parseInt(i.slice(0,-1))/100;n=parseInt(t*a)}}return n}function d(t){var n=t.slider,e=t.slide,a=t.min_width,r=t.min_height,s=t.slider_ratio,o=t.calc_width,d=t.calc_height,c=40;o=Math.min(n.parent().width(),i(window).width()-c);var m=i("#minimus-slide"+t.instance+"_"+t.current),u=m.find("img");if(u.length>0){var h=u,l=new Image;l.onload=function(){var i=l.width,n=l.height,e=n/i,a=t.slider,r=t.calc_width,s=t.calc_height,o=Math.round(r*e);if("adjust"==t.options.ratio)m.css({height:o}),u.css({width:r,height:o}),a.css({height:o});else if(o>s){var d=Math.round((o-s)/2);u.css({width:r,height:o,top:-d})}else{var c=Math.round(s/e),h=Math.round((c-r)/2);u.css({width:c,height:s,left:-h})}},l.src=h.attr("src")}return d=Math.round(o*s),a>o&&(o=a,d=Math.round(o*s),r>d&&(d=r)),r>d&&(d=r,o=Math.round(d/s),a>o&&(o=a)),e.css({width:o,height:d}),e.children("video,iframe").css({width:o,height:d}),n.css({width:o,height:d}),t.calc_width=o,t.calc_height=d,t.slide=e,t.slider=n,t}var c=[],m=0,u={init:function(n){this.each(function(){var e={width:"100%",height:"100%",ratio:.5625,animation_type:"horizontal",animation_duration:600,animation_start:"manual",animation_interval:4e3},a=i(this),r=a.data("minimus"),s=i(),d=i(),u=i(),h=i(),l=i(),f=i(),v=i(),g=0,p=0,w=0,_=100,x=.565,T=0,y=0,b=320,M=180,E={},D=window.devicePixelRatio>1.3||window.matchMedia&&window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches;if(E.swipeTreshold=100,E.allowedTime=300,s=i.extend(e,n),a.attr("data-id","minimus-slider_"+m),d=a.find(".minimus-slide"),p=d.length-1,d.each(function(t){i(this).attr("id","minimus-slide"+m+"_"+t)}),u=a.next(".minimus-navslide"),h=u.find(".minimus-start").attr("data-id","minimus-start_"+m),l=u.find(".minimus-stop").attr("data-id","minimus-stop_"+m),f=u.find(".minimus-next").attr("data-id","minimus-next_"+m),v=u.find(".minimus-prev").attr("data-id","minimus-prev_"+m),T=o(s.width,a.parent().width()),"number"==typeof s.ratio&&(x=s.ratio),y=Math.round(T*x),d.css({"box-sizing":"content-box",width:T,height:y,top:0,left:0}),void 0!==typeof d.children("img").attr("data-src")&&d.children("img").attr("src")!==d.children("img").attr("data-src")){var k=d.children("img").attr("src");d.children("img").css({background:"url("+k+") no-repeat center center"})}return d.children("img,video,iframe").css({"box-sizing":"content-box",width:T,height:y}),d.not(":first").hide(),d.filter(":first").addClass("active"),a.css({"box-sizing":"content-box",width:T,height:y}),f.on("click touchstart touchend",function(t){t.preventDefault(),i(this).minimus("next")}),v.on("click touchstart touchend",function(t){t.preventDefault(),i(this).minimus("prev")}),l.on("click",function(t){t.preventDefault(),a.minimus("stop"),i(this).hide(),h.show()}),h.on("click",function(t){t.preventDefault(),a.minimus("start"),i(this).hide(),l.show()}),i(document).on("touchstart",a,function(i){var t=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];void 0===i.originalEvent.touches&&(t=i),E.ox=t.pageX,E.oy=t.pageY,E.startTime=(new Date).getTime()}),i(document).on("touchend",a,function(i){var t=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];void 0===i.originalEvent.touches&&(t=i),E.dx=t.pageX-E.ox,E.dy=t.pageY-E.oy,E.endTime=(new Date).getTime()-E.startTime,(E.dx<-E.swipeTreshold||E.dy<-E.swipeTreshold)&&E.endTime<E.allowedTime?a.minimus("next"):(E.dx>E.swipeTreshold||E.dy>E.swipeTreshold)&&E.endTime<E.allowedTime&&a.minimus("prev")}),a.data("minimus",{slider:a,slide:d,totslides:p,margin:_,navslide:u,start:h,stop:l,prev:v,next:f,current:g,timer:w,options:s,instance:m,slider_ratio:x,calc_width:T,calc_height:y,min_width:b,min_height:M,mm:E,is_retina:D}),r=a.data("minimus"),c[m]=r,t(a.data("minimus")),i.fn.minimus("resize",m),"auto"==s.animation_start?(l.show(),h.hide(),a.minimus("start")):"manual"==s.animation_start&&(a.minimus("stop"),l.hide(),h.hide()),m++,c})},next:function(){var a=s(i(this).attr("data-id")),o=c[a],d=o.current;return o.current++,o.current>o.totslides&&(o.current=0),r(a,d),t(o),e(o,d,"n"),n(o),c[a]=o,c},prev:function(){var a=s(i(this).attr("data-id")),o=c[a],d=o.current;return o.current--,o.current<0&&(o.current=o.totslides),r(a,d),t(o),e(o,d,"p"),n(o),c[a]=o,c},resize:function(t){"number"!=typeof t&&(t=s(i(this).attr("data-id")));var n=c[t];return n=d(n),c[t]=n,c},start:function(){var t=s(i(this).attr("data-id")),n=c[t],e=n.slider;return 0!==n.timer&&clearInterval(n.timer),n.timer=setInterval(function(){e.minimus("next")},n.options.animation_interval),c[t]=n,c},stop:function(){var t=s(i(this).attr("data-id")),n=c[t];return clearInterval(n.timer),c[t]=n,c},destroy:function(){var t=s(i(this).attr("data-id")),n=c[t];n.prev.off(),n.next.off(),i.fn.minimus("stop"),n.slide.find("minimus-caption").remove(),i.removeData(n,"minimus"),this.unbind(),this.element=null}};i(window).resize(function(){for(var t=0;m>t;t++)i.fn.minimus("resize",t)}),i.fn.minimus=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void i.error("Method "+t+" does not exist on jQuery.minimus"):u.init.apply(this,arguments)}}(jQuery);